/* Custom font imports - must be first */
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Theme CSS Custom Properties */
:root {
  /* Dark mode (default) */
  --color-bg-primary: #1C1C1C;
  --color-bg-secondary: #121212;
  --color-bg-surface: #2A2724;
  --color-border: #3D3A36;
  --color-text-primary: #F5F0E8;
  --color-text-secondary: #A0A0A0;
  --color-text-tertiary: #6B6B6B;
  --color-accent-amber: #D4A574;
  --color-accent-terracotta: #C4725B;
  --color-accent-sage: #7D8B75;
  --color-scrollbar-track: #121212;
  --color-scrollbar-thumb: #2A2724;
  --image-filter: saturate(0.8) sepia(0.1) contrast(1.05) brightness(0.95);
  --header-bg: 28, 28, 28; /* RGB values for rgba() usage */
}

[data-theme="light"] {
  /* Light mode */
  --color-bg-primary: #FAF8F5;
  --color-bg-secondary: #FFFFFF;
  --color-bg-surface: #F0EDE8;
  --color-border: #E0DCD4;
  --color-text-primary: #1C1C1C;
  --color-text-secondary: #5A5A5A;
  --color-text-tertiary: #8A8A8A;
  --color-accent-amber: #B8864A;
  --color-accent-terracotta: #A85A42;
  --color-accent-sage: #5D6B55;
  --color-scrollbar-track: #F0EDE8;
  --color-scrollbar-thumb: #D4CFC6;
  --image-filter: saturate(0.9) contrast(1.02) brightness(1.02);
  --header-bg: 250, 248, 245; /* RGB values for rgba() usage */
}

@layer base {
  html {
    @apply scroll-smooth;
    font-feature-settings: "kern" 1, "liga" 1;
  }

  body {
    background-color: var(--color-bg-primary);
    color: var(--color-text-primary);
    @apply font-sans text-body antialiased transition-colors duration-300;
  }

  /* Warm selection colors */
  ::selection {
    background-color: rgba(212, 165, 116, 0.3);
    color: var(--color-text-primary);
  }

  /* Smooth focus states */
  :focus-visible {
    outline-color: var(--color-accent-amber);
    @apply outline-2 outline-offset-2;
  }

  /* Premium scrollbar styling */
  ::-webkit-scrollbar {
    @apply w-2;
  }

  ::-webkit-scrollbar-track {
    background-color: var(--color-scrollbar-track);
  }

  ::-webkit-scrollbar-thumb {
    background-color: var(--color-scrollbar-thumb);
    @apply rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-border);
  }

  /* Typography base */
  h1, h2, h3, h4, h5, h6 {
    @apply font-serif text-text-primary;
  }

  h1 { @apply text-h1; }
  h2 { @apply text-h2; }
  h3 { @apply text-h3; }

  p {
    @apply mb-4 last:mb-0;
  }

  a {
    @apply text-accent-amber hover:text-accent-terracotta transition-colors duration-200;
  }

  /* Code styling */
  code {
    @apply font-mono text-accent-amber bg-garden-surface px-1.5 py-0.5 rounded text-small;
  }

  pre {
    @apply bg-garden-black p-4 rounded-lg overflow-x-auto;
  }

  pre code {
    @apply bg-transparent p-0;
  }
}

@layer components {
  /* Card component */
  .card {
    @apply bg-garden-surface rounded-xl p-6 border border-garden-border/50;
  }

  .card-hover {
    @apply card transition-all duration-300 hover:border-accent-amber/30 hover:shadow-lg hover:shadow-accent-amber/5;
  }

  /* Button variants */
  .btn {
    @apply inline-flex items-center justify-center px-6 py-3 rounded-lg font-sans font-medium transition-all duration-200;
  }

  .btn-primary {
    @apply btn bg-accent-amber text-garden-black hover:bg-accent-terracotta;
  }

  .btn-ghost {
    @apply btn border border-garden-border text-text-primary hover:border-accent-amber hover:text-accent-amber;
  }

  /* Maturity indicators */
  .maturity-seedling {
    @apply text-maturity-seedling;
  }

  .maturity-budding {
    @apply text-maturity-budding;
  }

  .maturity-evergreen {
    @apply text-maturity-evergreen;
  }

  /* Wiki link styling */
  .wiki-link,
  .wikilink {
    @apply text-accent-amber border-b border-accent-amber/30 hover:border-accent-amber transition-colors duration-200 no-underline;
  }

  .wikilink-broken {
    @apply text-accent-terracotta border-b border-dashed border-accent-terracotta/50 cursor-help;
  }

  /* Section containers */
  .section {
    @apply py-16 md:py-24 lg:py-32;
  }

  .container-narrow {
    @apply max-w-3xl mx-auto px-6;
  }

  .container-wide {
    @apply max-w-6xl mx-auto px-6;
  }

  /* Photography treatment - harmonizes images with dark palette */
  .treated-image {
    filter: saturate(0.8) sepia(0.1) contrast(1.05) brightness(0.95);
    @apply rounded-lg border border-garden-border/30 transition-all duration-300;
  }

  .treated-image:hover {
    @apply scale-[1.02] shadow-lg shadow-garden-black/50;
  }

  /* Image container for prose and general use */
  .image-container {
    @apply relative overflow-hidden rounded-lg border border-garden-border/30;
  }

  .image-container img {
    filter: saturate(0.8) sepia(0.1) contrast(1.05) brightness(0.95);
    @apply w-full h-auto transition-transform duration-500;
  }

  .image-container:hover img {
    @apply scale-[1.02];
  }

  /* Figure styling for captioned images */
  .image-figure {
    @apply my-8;
  }

  .image-figure img {
    filter: saturate(0.8) sepia(0.1) contrast(1.05) brightness(0.95);
    @apply rounded-lg border border-garden-border/30 w-full;
  }

  .image-figure figcaption {
    @apply text-small text-text-tertiary mt-3 text-center italic;
  }
}

@layer utilities {
  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Text balance for headlines */
  .text-balance {
    text-wrap: balance;
  }

  /* Gradient text */
  .gradient-text {
    @apply bg-gradient-to-r from-accent-amber to-accent-terracotta bg-clip-text text-transparent;
  }
}

/* Enhanced View Transitions */
@supports (view-transition-name: none) {
  /* Header persists across transitions */
  .site-header {
    view-transition-name: site-header;
  }

  /* Main content area transitions */
  .main-content {
    view-transition-name: main-content;
  }

  /* Page title transitions for note cards */
  [data-note-transition] {
    view-transition-name: var(--note-transition-name);
  }

  /* Asymmetric timing for snappier feel */
  ::view-transition-old(main-content) {
    animation: fade-scale-out 0.2s ease-in forwards;
  }

  ::view-transition-new(main-content) {
    animation: fade-scale-in 0.3s ease-out forwards;
  }

  /* Header stays static during transitions */
  ::view-transition-old(site-header),
  ::view-transition-new(site-header) {
    animation: none;
  }

  @keyframes fade-scale-out {
    to {
      opacity: 0;
      transform: scale(0.98);
    }
  }

  @keyframes fade-scale-in {
    from {
      opacity: 0;
      transform: scale(1.02);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
}
